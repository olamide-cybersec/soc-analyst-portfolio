# Windows Malware Analysis Basics – Quick Guide

This guide provides the foundational knowledge required for SOC Analysts to perform malware triage and behavioral analysis on Windows systems.

It covers:
- Static malware analysis
- Dynamic (behavioral) analysis
- Key Windows locations malware targets
- Important Sysmon Event IDs
- Tools used by SOC and Incident Response teams
- Signs of malicious activity
- Documentation standards

---

# ⭐ 1. Types of Malware Analysis

Malware analysis has two main categories:

---

## 1.1 Static Malware Analysis (SAFE)
You inspect the file **without running it**.

### What you check:
- File name  
- File size  
- File hash (SHA-256)  
- File metadata (publisher / signature)  
- Imports (kernel32.dll, advapi32.dll, wininet.dll, ws2_32.dll)  
- Strings inside the file  
- VirusTotal reputation  

### Why it's important:
Static analysis tells you what the malware *might* do  
**before you execute anything.**

---

## 1.2 Dynamic (Behavioral) Analysis (RUN IN A VM)
You execute the malware in a controlled environment.

### What you check:
- Processes created  
- Command-line arguments  
- Network connections  
- Registry changes  
- Persistence mechanisms  
- File system changes  
- DLL loads  
- Memory behavior  

### Why it's important:
Behavior does not lie.  
If the malware spawns PowerShell, creates EXEs, or calls an IP → it's malicious.

---

# ⭐ 2. Windows Malware Analysis Toolkit (Essential Tools)

These are the tools professional SOC and IR teams actually use:

---

## 2.1 Process Explorer (Sysinternals)
Use it for:
- Parent-child relationships  
- Suspicious command lines  
- Unsigned executables  
- Loaded DLLs  
- Process injection indicators  

---

## 2.2 Process Monitor (ProcMon)
Your MOST important tool.

Tracks:
- File system activity  
- Registry changes  
- Process launches  
- Network activity  
- DLL loads  

SOC analysts rely heavily on ProcMon to understand malware behavior.

---

## 2.3 Autoruns
Identifies persistence:
- Registry Run keys  
- Scheduled tasks  
- Services  
- Startup folders  
- Browser extensions  

If malware tries to survive a reboot → Autoruns will reveal it.

---

## 2.4 RegShot
A simple but powerful tool.

- Snapshot registry before infection  
- Snapshot after infection  
- Compare changes  
- Shows exactly what malware modified  

---

## 2.5 VirusTotal
Checks:
- Hash reputation  
- Community comments  
- File behavior  
- Domains / IP addresses  
- Detection names  

---

## 2.6 ANY.RUN (optional)
Interactive sandbox:
- Process tree  
- File changes  
- DNS requests  
- Network traffic  
- Persistence  

Perfect for quick triage, even in real SOC work.

---

# ⭐ 3. SOC Malware Triage Method (5-Step Process)

This is the EXACT workflow used by SOC analysts in real environments.

---

## Step 1. Identify the Suspicious File
Check:
### A) File Extension
- `.exe` → executable  
- `.js`, `.vbs` → script  
- `.docm` → macro-enabled  
- `.lnk` → weaponized shortcuts

### B) File Size
- Tiny EXEs (<100 KB) → droppers  
- Large EXEs (>1 MB) → packed/legit  

### C) File Name
Common malware tricks:
- `invoice.pdf.exe`  
- `payment_copy.zip`  
- `photos.zip.scr`  
- `update_KB00123.exe`  

### D) File Hash
Always calculate SHA-256.

---

## Step 2. Perform Static Analysis
Use:
- Strings  
- PEStudio  
- VirusTotal  

Look for:
- URLs  
- IP addresses  
- suspicious commands (`powershell -enc`, `cmd /c`, `curl`)  
- Base64 encoded content  
- DLL imports (networking, registry, crypto)  

---

## Step 3. Prepare Your Safe Lab
You MUST use:
- A Windows VM  
- NAT or no internet  
- Snapshot before running malware  

If the VM breaks → revert snapshot.

---

## Step 4. Perform Dynamic Analysis
Monitor:

### A) Process Creation
In Process Explorer:
- Malware spawning PowerShell  
- Malware spawning cmd.exe  
- Rundll32 usage  
- Explorer.exe injection  

### B) File System Changes
Common hiding places:
- `%APPDATA%`  
- `%TEMP%`  
- `%LOCALAPPDATA%`  
- `%PROGRAMDATA%`  
- Startup folders  

### C) Registry Changes
Persistence keys:
HKCU\Software\Microsoft\Windows\CurrentVersion\Run
HKLM\Software\Microsoft\Windows\CurrentVersion\Run
HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce


### D) Network Activity
Watch for:
- Outbound connections  
- Suspicious domains  
- HTTP requests  
- DNS lookups  

Example:
invoice.pdf.exe → hxxp://198.45.112.133/upload


---

## Step 5. Document Findings Like a Real Analyst
Your report must include:
- Summary of behavior  
- Processes spawned  
- Files created  
- Registry modifications  
- Persistence method  
- Network indicators  
- MITRE ATT&CK mapping  
- Recommendations  

This is how SOC analysts communicate incident impact.

---

# ⭐ 4. Critical Sysmon Event IDs (Memorize These)

| Event ID | Meaning                      | Why It Matters |
|----------|-------------------------------|----------------|
| **1**    | Process creation              | Detects malware execution, PowerShell |
| **3**    | Network connections           | Detects C2, payload downloads |
| **7**    | Image loaded                  | DLL injection indicators |
| **8**    | CreateRemoteThread            | Process injection / malicious activity |
| **11**   | File creation                 | Malware dropping payloads |
| **12**   | Registry object created       | Persistence |
| **13**   | Registry value modified       | Persistence |

These are the heart of Windows threat detection.

---

# ⭐ 5. Final Notes

This guide prepares you for:
- SOC Tier 1  
- SOC Tier 2  
- Malware triage analyst  
- IR junior roles  

To go deeper (NOT required for SOC):
- Reverse engineering with Ghidra/IDA  
- YARA rule writing  
- Memory forensics  

But for SOC, this guide + your malware project is MORE than enough.

---

# ✔ End of Guide





















